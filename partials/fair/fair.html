<div class="row background-violet">
	<div class="col-xs-6 text-white">
		<h2>Minha cesta</h2>

		<hr>

		<div ng-if="!$storage.basket.products.length">
			<h4>A sua cesta está vazia!</h4>
			<p>Adicione novos produtos clicando no botão "Colocar na cesta".</p>
		</div>
		<div ng-if="$storage.basket.products.length">

			<div class="row small" ng-repeat="product in $storage.basket.products" style="border-bottom: 1px solid #b464b4;">
				<div class="col-xs-3 text-right" ng-bind="product.quantity"></div>
				<div class="col-xs-15">
					<a href="#/fair/product/{{product._id}}" 
						class="text-white" 
						ng-bind="product.name" 
						tooltip-placement="right" 
						tooltip-html-unsafe="{{product.name}} <hr> {{product.dscr}}"
						tooltip-append-to-body="true" 
						ng-dblclick="dropFromBasket(product)"
					></a>
				</div>
				<div class="col-xs-4 text-left" ng-bind="product.quantity*product.price | currency:'R$':2"></div>
				<div class="col-xs-2 text-left">
					<a class="text-white" href="javascript:void(0)" ng-click="dropFromBasket(product)">x</a>
				</div>

			</div>

			<hr>

			<h4><strong>Total: </strong>{{$storage.basket.total | currency:'R$':2}}</h4>

			<hr>

			<a class="btn btn-success btn-lg btn-block" href="#/order_review">
				Fechar meu pedido <br>
				<small>Compra 100% segura.</small>
			</a>
			<br>
			<small>* A Feira Orgânica Delivery utiliza o Pagseguro como gateway de pagamentos, garantindo assim uma compra segura e muito simples.</small>
			<br>
			<small>** As entregas são realizadas nas Terças e Sábados e o frete custa apenas R$6,00.</small>
			<br>
			<small>*** O valor mínimo para a compra de produtos é de R$35,00.</small>
			<br>
			<img class="img-responsive" src="https://s3-sa-east-1.amazonaws.com/fodev/img/global/pagseguro.png">

		</div>
	</div>

	<div class="col-xs-18 text-left background-white">

		<div class="row">
			<div class="col-xs-offset-1 col-xs-22">

				<br>

				<form class="form-inline text-right">
					<div class="form-group">
						<label for="productQuery">Buscar produto</label>
						<input class="form-control input-xs" id="productQuery" name="productQuery" ng-model="productQuery" type="text" placeholder="Buscar produto" autofocus>
					</div>
					<div class="form-group">
						<label for="selectedOrder">Ordem</label>
						<select class="form-control" id="selectedOrder" name="selectedOrder" ng-model="selectedOrder">
							<option value="name">Nome</option>
							<option value="price">Preço</option>
							<option value="category">Categoria</option>
							<option value="highlight">Destaque</option>
						</select>
					</div>
				</form>

				<br>

				<div class="btn-group" role="group" aria-label="productKind">
					<button type="button" class="btn btn-sm btn-primary" ng-class="selectedCategory == '' ? 'active' : ''" ng-click="selectCategory('')">Tudo</button>
					<button ng-repeat="product in filteredProducts = (products | filter: productQuery | orderBy: 'category' | groupBy: 'category')" type="button" class="btn btn-sm btn-primary" ng-class="selectedCategory == product[0].category ? 'active' : ''" ng-click="selectCategory(product[0].category)">{{product[0].category}}</button>
				</div>

				<br>
				<br>

				<div class="row">
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12" ng-repeat="product in filteredProducts = (products | filter: productQuery | filter: {category : selectedCategory} | orderBy: selectedOrder)">


						<div class="thumbnail">
							<a href="#/fair/product/{{product._id}}">
								<img class="img-responsive" alt="week_product" ng-src="http://images.elasticbeanstalk.com/200/{{product.img}}" ng-dblclick="addToBasket(product)">
							</a>
							<hr>
							<div style="height:100px;">
								<p>
									<span ng-bind="product.price | currency:'R$':2"></span>
									<span class="pull-right">
										<a ng-if="product.category" ng-click="selectCategory(product.category)" ng-bind="product.category"></a>
									</span>
								</p>
								<h4 class="text-violet"><a href="#/fair/product/{{product._id}}" ng-bind="product.name"></a></h4>
							</div>

							<button class="btn btn-primary btn-block" ng-click="addToBasket(product)">Colocar na cesta 
								<span class="label label-warning" ng-repeat="buttonProduct in $storage.basket.products | filter : {_id: product._id}" ng-bind="buttonProduct.quantity"></span>
							</button>

						</div>


					</div>
					<div class="col-xs-24" ng-if="!filteredProducts.length">Nesta sema a não temos nenhum produto da categoria {{selectedCategory}}!
						<br></br>
					</div>
				</div>

			</div>
		</div>

	</div>
</div>